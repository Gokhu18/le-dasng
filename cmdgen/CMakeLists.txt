cmake_minimum_required(VERSION 2.8.8)
cmake_policy(SET CMP0048 NEW)
project(cmdgen VERSION 2.0.0)
set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

find_package(FLEX REQUIRED)
find_package(BISON REQUIRED)

FLEX_TARGET(CmdScanner yylex.l ${CMAKE_CURRENT_BINARY_DIR}/yylex.c)
BISON_TARGET(CmdParser yyparse.y ${CMAKE_CURRENT_BINARY_DIR}/yyparse.c)

set(CURSES_NEED_NCURSES, TRUE)

add_executable(cmdgen cmdgen.c dstructs.c interfaces.c prompts.c
    rules.c states.c trie.c vunion.c cmdgenoui.c
    ${BISON_CmdParser_OUTPUT_SOURCE}
    ${FLEX_CmdScanner_OUTPUTS})
target_include_directories(cmdgen PRIVATE
  ${CMAKE_CURRENT_SOURCE_DIR}
  ${le_das_SOURCE_DIR}/nl/src
  ${le_das_SOURCE_DIR}/oui/src)
target_link_libraries(cmdgen nl)
install(TARGETS cmdgen RUNTIME
        DESTINATION bin)
install(FILES cmdalgo.h
        DESTINATION include)
install(FILES cmdgen.skel
        DESTINATION share/linkeng)

# cmdgenoui.c is generated by:
#   oui -o cmdgenoui.c cmdgen.oui
